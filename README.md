# XV6 Lottery Process Scheduler

This is a lottery scheduling system in the XV6 OS that I created for my operating systems class. We added system calls that allow a user to set the "nice" and "priority" values of a process, two values that proesses have in Linux machines that relate to how much CPU time they will consume. 

In proc.c, the lottery scheduling algorithm is changed to include a pseudo random algorithm in the xorshift family. I used the 32 bit xorshift function to generate random numbers, with a max number that the random generation should return. The xorshift operation uses a seed and xors it with a bit shifted seed. This happens a few times and the final result is modded with the max+1 to ensure that the returned value is at most max. Each process is initialized with a number of tickets, which makes up the "max" number that will be used in xorshift. I decided to make the ticket allocation 20 (just as nice has a range of -20 to 19, the ticket count will have a range of 1-40) at the start, then the user picks a number to set the ticket as. With this, a process with double the amount of tickets as another will still run twice as fast for large time periods. 

Instead of the original scheduler, where the first runnable process was chosen, the lottery scheduler adds up all the ticket allocations from the runnable processes, and selects a winner using xorshift. The generator is updated this time to have a new seed chosen each time it runs by updating a global seed variable with each run and using that. This ensures that a new output is given by the random function (if the seed is hard coded in it will give the same output every time, and if no process enters or exits then that process will be in an infinite loop of being chosen in the lottery since it is deterministic). The scheduler then finds the process with that ticket number and runs it if it is runnable. If it is not runnable, the scheduler continues through the list and runs the next runnable process. The lottery function recalculates the tickets for each round, meaning if a process finishes it will no longer be considered, or if a new process is added to the PCB, it will be assigned tickets like the rest.
